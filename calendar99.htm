
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0106)http://www.smia.gov.tw/calendar.htm -->
<!-- saved from url=(0022)http://internet.e-mail --><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" ""><!-- saved from url=(0049)http://joke.maillist.com.tw/files/08/00080501.htm --><!-- saved from url=(0022)http://internet.e-mail --><HTML><HEAD><META 
content="IE=5.0000" http-equiv="X-UA-Compatible">
<TITLE>月曆</TITLE><!-- ********************************************

************************************************** --> 
<META name="keywords" content="農曆; 陽曆; 月曆; 節日; 時區; 節氣; 八字; 干支; 生肖; gregorian solar; chinese lunar; calendar;"> 
<META name="robots" content="All"> 
<META name="description" content="gregorian solar calendar and chinese lunar calendar"> 
<META http-equiv="Content-Type" content="text/html; charset=big5"> 
<SCRIPT language="JavaScript">

//<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
//<html xmlns="http://www.w3.org/1999/xhtml">
//<head><title>萬年曆</title>
//<meta http-equiv=Content-Type content="text/html; charset=gb2312">
//<meta content="all" name="robots">
//<script language="javascript">



<!--
/*****************************************************************************
                                   日期資料
*****************************************************************************/

var lunarInfo=new Array(
0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,
0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,
0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,
0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,
0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,
0x06ca0,0x0b550,0x15355,0x04da0,0x0a5b0,0x14573,0x052b0,0x0a9a8,0x0e950,0x06aa0,
0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,
0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b6a0,0x195a6,
0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,
0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x055c0,0x0ab60,0x096d5,0x092e0,
0x0c960,0x0d954,0x0d4a0,0x0da50,0x07552,0x056a0,0x0abb7,0x025d0,0x092d0,0x0cab5,
0x0a950,0x0b4a0,0x0baa4,0x0ad50,0x055d9,0x04ba0,0x0a5b0,0x15176,0x052b0,0x0a930,
0x07954,0x06aa0,0x0ad50,0x05b52,0x04b60,0x0a6e6,0x0a4e0,0x0d260,0x0ea65,0x0d530,
0x05aa0,0x076a3,0x096d0,0x04bd7,0x04ad0,0x0a4d0,0x1d0b6,0x0d250,0x0d520,0x0dd45,
0x0b5a0,0x056d0,0x055b2,0x049b0,0x0a577,0x0a4b0,0x0aa50,0x1b255,0x06d20,0x0ada0,
0x14b63);

var solarMonth=new Array(31,28,31,30,31,30,31,31,30,31,30,31);
var Gan=new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸");
var Zhi=new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥");
var Animals=new Array("鼠","牛","虎","兔","龍","蛇","馬","羊","猴","雞","狗","豬");
var solarTerm = new Array("小寒","大寒","立春","雨水","驚蟄","春分","清明","穀雨","立夏","小滿","芒種","夏至","小暑","大暑","立秋","處暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至");
var sTermInfo = new Array(0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758);
var nStr1 = new Array('日','一','二','三','四','五','六','七','八','九','十');
var nStr2 = new Array('初','十','廿','卅','卌');
var monthName = new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");

//國曆節日 *表示放假日
var sFtv = new Array(
"0101*元旦",
"0111 司法節",
"0115 藥師節",
"0123 自由日",
"0127 武英華生日",
"0130 石光弘生日",
"0204 農民節",
"0207 石昀詩生日",
"0214 情人節",
"0215 戲劇節",
"0219 新生活運動紀念日",
"0228*和平紀念日",
"0301 兵役節",
"0305 石晴萱生日",
"0308 婦女節",
"0312 植樹節 國父逝世紀念日",
"0317 國醫節",
"0320 石忠一生日",
"0321 氣象節",
"0325 美術節",
"0326 廣播節",
"0329 青年節 革命先烈紀念日",
"0330 出版節",
"0401 愚人節 主計節",
"0404 婦幼節",
"0405 音樂節",
"0407 衛生節",
"0422 世界地球日",
"0501*勞動節",
"0502 石協坤生日",
"0505 陳美華生日",
"0508 陳麗華生日",
"0504 文藝節",
"0505 舞蹈節",
"0510 珠算節",
"0512 護士節",
"0603 禁煙節",
"0606 工程師節 水利節",
"0609 鐵路節",
"0615 警察節",
"0630 會計師節",
"0701 漁民節 公路節 稅務節",
"0706 合作節",
"0708 石晴雯生日",
"0711 航海節",
"0712 聾啞節",
"0716 石劉好生日",
"0808 父親節",
"0814 空軍節",
"0827 鄭成功\誕辰",
"0901 記者節",
"0903 軍人節 抗戰紀念",
"0909 體育節 律師節",
"0913 法律日",
"0928 教師節 孔子誕辰",
"1006 老人節",
"1010*國慶紀念日",
"1017 石國村生日",
"1021 華僑節",
"1025 台灣光復節",
"1031 萬聖節 蔣公誕辰紀念日 榮民節",
"1101 商人節",
"1111 工業節 地政節",
"1117 自來水節",
"1112 國父誕辰紀念日 醫師節 中華文化復興節",
"1113 結婚紀念日",
"1121 防空節",
"1205 海員節 盲人節",
"1210 人權節",
"1212 憲兵節",
"1225 行憲紀念日 民族復興節 聖誕節",
"1227 建築師節",
"1228 電信節",
"1229 武淑華生日",
"1231 受信節");

//農曆節日 *表示放假日
var lFtv = new Array(
"0101*春節",
"0102*回娘家",
"0103*祭祖",
"0104*迎神",
"0105*開市",
"0109 天公生",
"0110 石昀詩農曆",
"0113 石忠二忌日",
"0115 元宵節 觀光節",
"0202 頭牙 土地公生",
"0207 石晴萱農曆",
"0223 石忠一農曆",
"0301 武王安蓮忌日",
"0312 石忠一忌日",
"0323 媽祖生",
"0327 石協坤農曆",
"0408 浴佛節",
"0505*端午節 詩人節",
"0522 石劉好農曆",
"0602 石秋木忌日",
"0607 石晴雯農曆",
"0701 開鬼門",
"0707 七夕情人節",
"0715 中元節",
"0800 關鬼門",
"0815*中秋節",
"0821 武誠忌日",
"0826 石國村農曆",
"0909 重陽節",
"1128 武淑華農曆",
"1208 臘八節",
"1215 石光弘農曆",
"1216 尾牙",
"1224 送神",
"1220 武英華農曆",
"0100*除夕");

//某月的第幾個星期幾
var wFtv = new Array(
//"0131 Martin Luther King Day",
//"0231 President's Day",
"0520 母親節",
//"0530 Armed Forces Day",
//"0531 Victoria Day",
//"0716 合作節",
//"0730 被奴役國家週",
//"0811 Civic Holiday",
//"0911 Labor Holiday",
//"1021 Columbus Day",
"1144 Thanksgiving");


/*****************************************************************************
日期計算
*****************************************************************************/

//====================================== 返回農曆 y年的總天數
function lYearDays(y) {
var i, sum = 348;
for(i=0x8000; i>0x8; i>>=1) sum += (lunarInfo[y-1900] & i)? 1: 0;
return(sum+leapDays(y));
}

//====================================== 返回農曆 y年閏月的天數
function leapDays(y) {
if(leapMonth(y))  return((lunarInfo[y-1900] & 0x10000)? 30: 29);
else return(0);
}

//====================================== 返回農曆 y年閏哪個月 1-12 , 沒閏返回 0
function leapMonth(y) {
return(lunarInfo[y-1900] & 0xf);
}

//====================================== 返回農曆 y年m月的總天數
function monthDays(y,m) {
return( (lunarInfo[y-1900] & (0x10000>>m))? 30: 29 );
}


//====================================== 算出農曆, 傳入日期控制項, 返回農曆日期控制項
//                                       該控制項屬性有 .year .month .day .isLeap
function Lunar(objDate) {

var i, leap=0, temp=0;
var offset   = (Date.UTC(objDate.getFullYear(),objDate.getMonth(),objDate.getDate()) - Date.UTC(1900,0,31))/86400000;

for(i=1900; i<2050 && offset>0; i++) { temp=lYearDays(i); offset-=temp; }

if(offset<0) { offset+=temp; i--; }

this.year = i;

leap = leapMonth(i); //閏哪個月
this.isLeap = false;

for(i=1; i<13 && offset>0; i++) {
//閏月
if(leap>0 && i==(leap+1) && this.isLeap==false)
{ --i; this.isLeap = true; temp = leapDays(this.year); }
else
{ temp = monthDays(this.year, i); }

//解除閏月
if(this.isLeap==true && i==(leap+1)) this.isLeap = false;

offset -= temp;
}

if(offset==0 && leap>0 && i==leap+1)
if(this.isLeap)
{ this.isLeap = false; }
else
{ this.isLeap = true; --i; }

if(offset<0){ offset += temp; --i; }

this.month = i;
this.day = offset + 1;
}

//==============================返回西曆 y年某m+1月的天數
function solarDays(y,m) {
if(m==1)
return(((y%4 == 0) && (y%100 != 0) || (y%400 == 0))? 29: 28);
else
return(solarMonth[m]);
}
//============================== 傳入 offset 返回干支, 0=甲子
function cyclical(num) {
return(Gan[num%10]+Zhi[num%12]);
}

//============================== 陰曆屬性
function calElement(sYear,sMonth,sDay,week,lYear,lMonth,lDay,isLeap,cYear,cMonth,cDay) {

this.isToday    = false;
//瓣句
this.sYear      = sYear;   //西元年4位元數字
this.sMonth     = sMonth;  //西元月數字
this.sDay       = sDay;    //西元日數字
this.week       = week;    //星期, 1個中文
//農曆
this.lYear      = lYear;   //西元年4位元數字
this.lMonth     = lMonth;  //農曆月數字
this.lDay       = lDay;    //農曆日數字
this.isLeap     = isLeap;  //是否為農曆閏月?
//八字
this.cYear      = cYear;   //年柱, 2個中文
this.cMonth     = cMonth;  //月柱, 2個中文
this.cDay       = cDay;    //日柱, 2個中文

this.color      = '';

this.lunarFestival = ''; //農曆節日
this.solarFestival = ''; //西曆節日
this.solarTerms    = ''; //節氣
}

//===== 某年的第n個節氣為幾日(從0小寒起算)
//function sTerm(y,n) {
//var offDate = new Date( ( 31556925974.7*(y-1900) + sTermInfo[n]*60000  ) + Date.UTC(1900,0,6,2,5) );
//return(offDate.getUTCDate());
//}

//===== 某年的第n個節氣為幾日(從0小寒起算)
var solarTermBase = new Array(4,19,3,18,4,19,4,19,4,20,4,20,6,22,6,22,6,22,7,22,6,21,6,21);
var solarTermIdx = '0123415341536789:;<9:=<>:=1>?012@015@015@015AB78CDE8CD=1FD01GH01GH01IH01IJ0KLMN;LMBEOPDQRST0RUH0RVH0RWH0RWM0XYMNZ[MB\\]PT^_ST`_WH`_WH`_WM`_WM`aYMbc[Mde]Sfe]gfh_gih_Wih_WjhaWjka[jkl[jmn]ope]qph_qrh_sth_W';
var solarTermOS = '211122112122112121222211221122122222212222222221222122222232222222222222222233223232223232222222322222112122112121222211222122222222222222222222322222112122112121222111211122122222212221222221221122122222222222222222222223222232222232222222222222112122112121122111211122122122212221222221221122122222222222222221211122112122212221222211222122222232222232222222222222112122112121111111222222112121112121111111222222111121112121111111211122112122112121122111222212111121111121111111111122112122112121122111211122112122212221222221222211111121111121111111222111111121111111111111111122111121112121111111221122122222212221222221222111011111111111111111111122111121111121111111211122112122112221222211221111011111101111111110111111111121111111111111111122112121112121122111111011111121111111111111111011111111112111111111111011111111111111111111221111011111101110111110111011011111111111111111221111011011101110111110111011011111101111111111211111001011101110111110110011011111101111111111211111001011001010111110110011011111101111111110211111001011001010111100110011011011101110111110211111001011001010011100110011001011101110111110211111001010001010011000100011001011001010111110111111001010001010011000111111111111111111111111100011001011001010111100111111001010001010000000111111000010000010000000100011001011001010011100110011001011001110111110100011001010001010011000110011001011001010111110111100000010000000000000000011001010001010011000111100000000000000000000000011001010000010000000111000000000000000000000000011001010000010000000';

function sTerm(y,n) {
   return(solarTermBase[n] +  Math.floor( solarTermOS.charAt( ( Math.floor(solarTermIdx.charCodeAt(y-1900)) - 48) * 24 + n  ) ) );
}


//============================== 返回陰曆控制項 (y年,m+1月)
/*
功能說明: 返回整個月的日期資料控制項

使用方式: OBJ = new calendar(年,零起算月);

OBJ.length      返回當月最大日
OBJ.firstWeek   返回當月一日星期

由 OBJ[日期].屬性名稱 即可取得各項值

OBJ[日期].isToday  返回是否為今日 true 或 false

其他 OBJ[日期] 屬性參見 calElement() 中的注解
*/
function calendar(y,m) {

var sDObj, lDObj, lY, lM, lD=1, lL, lX=0, tmp1, tmp2, tmp3;
var cY, cM, cD; //年柱,月柱,日柱
var lDPOS = new Array(3);
var n = 0;
var firstLM = 0;

sDObj = new Date(y,m,1,0,0,0,0);    //當月一日日期

this.length    = solarDays(y,m);    //西曆當月天數
this.firstWeek = sDObj.getDay();    //西曆當月1日星期幾

////////年柱 1900年立春後為庚子年(60進制36)
if(m<2) cY=cyclical(y-1900+36-1);
else cY=cyclical(y-1900+36);
var term2=sTerm(y,2); //立春日期

////////月柱 1900年1月小寒以前為 丙子月(60進制12)
var firstNode = sTerm(y,m*2) //返回當月「節」為幾日開始
cM = cyclical((y-1900)*12+m+12);

//當月一日與 1900/1/1 相差天數
//1900/1/1與 1970/1/1 相差25567日, 1900/1/1 日柱為甲戌日(60進制10)
var dayCyclical = Date.UTC(y,m,1,0,0,0,0)/86400000+25567+10;

for(var i=0;i<this.length;i++) {

if(lD>lX) {
sDObj = new Date(y,m,i+1);    //當月一日日期
lDObj = new Lunar(sDObj);     //農曆
lY    = lDObj.year;           //農曆年
lM    = lDObj.month;          //農曆月
lD    = lDObj.day;            //農曆日
lL    = lDObj.isLeap;         //農曆是否閏月
lX    = lL? leapDays(lY): monthDays(lY,lM); //農曆當月最後一天

if(n==0) firstLM = lM;
lDPOS[n++] = i-lD+1;
}

//依節氣調整二月分的年柱, 以立春為界
if(m==1 && (i+1)==term2) cY=cyclical(y-1900+36);
//依節氣月柱, 以「節」為界
if((i+1)==firstNode) cM = cyclical((y-1900)*12+m+13);
//日柱
cD = cyclical(dayCyclical+i);

//sYear,sMonth,sDay,week,
//lYear,lMonth,lDay,isLeap,
//cYear,cMonth,cDay
this[i] = new calElement(y, m+1, i+1, nStr1[(i+this.firstWeek)%7],
lY, lM, lD++, lL,
cY ,cM, cD );
}

//節氣
tmp1=sTerm(y,m*2  )-1;
tmp2=sTerm(y,m*2+1)-1;
this[tmp1].solarTerms = solarTerm[m*2];
this[tmp2].solarTerms = solarTerm[m*2+1];
if(m==3) this[tmp1].color = 'red'; //清明顏色

//西曆節日
for(i in sFtv)
if(sFtv[i].match(/^(\d{2})(\d{2})([\s\*])(.+)$/))
if(Number(RegExp.$1)==(m+1)) {
this[Number(RegExp.$2)-1].solarFestival += RegExp.$4 + ' ';
if(RegExp.$3=='*') this[Number(RegExp.$2)-1].color = 'red';
}

//月周節日
for(i in wFtv)
if(wFtv[i].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/))
if(Number(RegExp.$1)==(m+1)) {
tmp1=Number(RegExp.$2);
tmp2=Number(RegExp.$3);
if(tmp1<5)
this[((this.firstWeek>tmp2)?7:0) + 7*(tmp1-1) + tmp2 - this.firstWeek].solarFestival += RegExp.$5 + ' ';
else {
tmp1 -= 5;
tmp3 = (this.firstWeek+this.length-1)%7; //當月最後一天星期?
this[this.length - tmp3 - 7*tmp1 + tmp2 - (tmp2>tmp3?7:0) - 1 ].solarFestival += RegExp.$5 + ' ';
}
}

//農曆節日
for(i in lFtv)
if(lFtv[i].match(/^(\d{2})(.{2})([\s\*])(.+)$/)) {
tmp1=Number(RegExp.$1)-firstLM;
if(tmp1==-11) tmp1=1;
if(tmp1 >=0 && tmp1<n) {
tmp2 = lDPOS[tmp1] + Number(RegExp.$2) -1;
if( tmp2 >= 0 && tmp2<this.length && this[tmp2].isLeap!=true) {
this[tmp2].lunarFestival += RegExp.$4 + ' ';
if(RegExp.$3=='*') this[tmp2].color = 'red';
}
}
}


//復活節只出現在3或4月
if(m==2 || m==3) {
var estDay = new easter(y);
if(m == estDay.m)
this[estDay.d-1].solarFestival = this[estDay.d-1].solarFestival+' 復活節 Easter Sunday';
}


if(m==2) this[20].solarFestival = this[20].solarFestival+unescape('%20%u6D35%u8CE2%u751F%u65E5');

//黑色星期五
if((this.firstWeek+12)%7==5)
this[12].solarFestival += '黑色星期五';

//今日
if(y==tY && m==tM) this[tD-1].isToday = true;
}

//======================================= 返回該年的復活節(春分後第一次滿月周後的第一主日)
function easter(y) {

var term2=sTerm(y,5); //取得春分日期
var dayTerm2 = new Date(Date.UTC(y,2,term2,0,0,0,0)); //取得春分的西曆日期控制項(春分一定出現在3月)
var lDayTerm2 = new Lunar(dayTerm2); //取得取得春分農曆

if(lDayTerm2.day<15) //取得下個月圓的相差天數
var lMlen= 15-lDayTerm2.day;
else
var lMlen= (lDayTerm2.isLeap? leapDays(y): monthDays(y,lDayTerm2.month)) - lDayTerm2.day + 15;

//一天等於 1000*60*60*24 = 86400000 毫秒
var l15 = new Date(dayTerm2.getTime() + 86400000*lMlen ); //求出第一次月圓為西曆幾日
var dayEaster = new Date(l15.getTime() + 86400000*( 7-l15.getUTCDay() ) ); //求出下個周日

this.m = dayEaster.getUTCMonth();
this.d = dayEaster.getUTCDate();

}

//====================== 中文日期
function cDay(d){
var s;

switch (d) {
case 10:
s = '初十'; break;
case 20:
s = '二十'; break;
break;
case 30:
s = '三十'; break;
break;
default :
s = nStr2[Math.floor(d/10)];
s += nStr1[d%10];
}
return(s);
}

///////////////////////////////////////////////////////////////////////////////

var cld;

function drawCld(SY,SM) {
var i,sD,s,size;
cld = new calendar(SY,SM);

//if(SY>1874 && SY<1909) yDisplay = '光緒' + (((SY-1874)==1)?'元':SY-1874);
//if(SY>1908 && SY<1912) yDisplay = '宣統' + (((SY-1908)==1)?'元':SY-1908);
//
//if(SY>1911) yDisplay = '<span class="gzage">建國' + (((SY-1949)==1)?'元':SY-1949);
//
//document.getElementById("GZ").innerHTML = yDisplay +'年</span> <span class="gznl">農曆 ' + cyclical(SY-1900+36) + '年 【'+Animals[(SY-4)%12]+'年】</span>';
//
//document.getElementById("YMBG").innerHTML = SY + "<br />" + monthName[SM];


   if(SY>1874 && SY<1909) yDisplay = '光緒' + (((SY-1874)==1)?'元':SY-1874);
   if(SY>1908 && SY<1912) yDisplay = '宣統' + (((SY-1908)==1)?'元':SY-1908);
   if(SY>1911) yDisplay = '民國' + (((SY-1911)==1)?'元':SY-1911);

   GZ.innerHTML = yDisplay +'年 農曆歲次' + cyclical(SY-1900+36) + '年 【'+Animals[(SY-4)%12]+'】';

   YMBG.innerHTML = "&nbsp;" + SY + "<BR>&nbsp;" + monthName[SM];


   
   
for(i=0;i<42;i++) {

sObj=document.getElementById('SD'+ i);
 
lObj=document.getElementById('LD'+ i);

sObj.className = '';

sD = i - cld.firstWeek;

if(sD>-1 && sD<cld.length) { //日期內
sObj.innerHTML = sD+1;

if(cld[sD].isToday) sObj.className = 'todyaColor'; //今日顏色

sObj.style.color = cld[sD].color; //法定假日顏色

if(cld[sD].lDay==1) //顯示農曆月
lObj.innerHTML = '<b>'+(cld[sD].isLeap?'閏':'') + cld[sD].lMonth + '月' + (monthDays(cld[sD].lYear,cld[sD].lMonth)==29?'小':'大')+'</b>';
else //顯示農曆日
lObj.innerHTML = cDay(cld[sD].lDay);

s=cld[sD].lunarFestival;
if(s.length>0) { //農曆節日
if(s.length>6) s = s.substr(0, 4)+'...';
s = s.fontcolor('red');
}
else { //西曆節日
s=cld[sD].solarFestival;
if(s.length>0) {
size = (s.charCodeAt(0)>0 && s.charCodeAt(0)<128)?8:4;
if(s.length>size+2) s = s.substr(0, size)+'...';
s=(s=='黑色星期五')?s.fontcolor('black'):s.fontcolor('blue');
}
else { //廿四節氣
s=cld[sD].solarTerms;
if(s.length>0) s = s.fontcolor('limegreen');
}
}

if(cld[sD].solarTerms=='清明') s = '清明節'.fontcolor('red');
if(cld[sD].solarTerms=='芒種') s = '芒種節'.fontcolor('red');
if(cld[sD].solarTerms=='夏至') s = '夏至節'.fontcolor('red');
if(cld[sD].solarTerms=='冬至') s = '冬至節'.fontcolor('red');



if(s.length>0) lObj.innerHTML = s;

}
else { //非日期
sObj.innerHTML = '';
lObj.innerHTML = '';
}
}
}


function changeCld() {
var y,m;
y=document.getElementById("CLD").SY.selectedIndex+1900;
m=document.getElementById("CLD").SM.selectedIndex;
drawCld(y,m);
}

function pushBtm(K) {
switch (K){
case 'YU' :
if(document.getElementById("CLD").SY.selectedIndex>0) document.getElementById("CLD").SY.selectedIndex--;
break;
case 'YD' :
if(document.getElementById("CLD").SY.selectedIndex<150) document.getElementById("CLD").SY.selectedIndex++;
break;
case 'MU' :
if(document.getElementById("CLD").SM.selectedIndex>0) {
document.getElementById("CLD").SM.selectedIndex--;
}
else {
document.getElementById("CLD").SM.selectedIndex=11;
if(document.getElementById("CLD").SY.selectedIndex>0) document.getElementById("CLD").SY.selectedIndex--;
}
break;
case 'MD' :
if(document.getElementById("CLD").SM.selectedIndex<11) {
document.getElementById("CLD").SM.selectedIndex++;
}
else {
document.getElementById("CLD").SM.selectedIndex=0;
if(document.getElementById("CLD").SY.selectedIndex<150) document.getElementById("CLD").SY.selectedIndex++;
}
break;
default :
document.getElementById("CLD").SY.selectedIndex=tY-1900;
document.getElementById("CLD").SM.selectedIndex=tM;
}
changeCld();
}

var Today = new Date();
var tY = Today.getFullYear();
var tM = Today.getMonth();
var tD = Today.getDate();
//////////////////////////////////////////////////////////////////////////////

var width = "200";
var offsetx = 2;
var offsety = 8;

var x = 0;
var y = 0;
var snow = 0;
var sw = 0;
var cnt = 0;

var dStyle;
document.onmousemove = mEvn;

//顯示詳細日期資料
function mOvr(v) {
var s,festival;
var sObj=document.getElementById('SD'+ v);
var d=sObj.innerHTML-1;

//sYear,sMonth,sDay,week,
//lYear,lMonth,lDay,isLeap,
//cYear,cMonth,cDay

if(sObj.innerHTML!='') {

sObj.style.cursor = 's-resize';

if(cld[d].solarTerms == '' && cld[d].solarFestival == '' && cld[d].lunarFestival == '')
festival = '';
else
festival = '<div class="festival">'+cld[d].solarTerms + ' ' + cld[d].solarFestival + ' ' + cld[d].lunarFestival+'</div>';
var hltxt='';
if(cld[d].sYear == 2008){
var hl = eval("HuangLi.d"+(cld[d].sMonth<10?('0'+cld[d].sMonth):cld[d].sMonth)+(cld[d].sDay<10?('0'+cld[d].sDay):cld[d].sDay));
if (hl)
{
hltxt='<br /><span class="hlyi">宜：'+hl.y+'</span><br /><span class="hlji">忌：'+hl.j+'</span>';
}
}
s= '<div class="topic">' +
'<div class="con"><span class="gday">'+
cld[d].sYear+'年'+cld[d].sMonth+'月'+cld[d].sDay+'日 星期'+cld[d].week+'</span><br />'+
'<span class="nday">農曆'+(cld[d].isLeap?'閏 ':' ')+cld[d].lMonth+'月'+cld[d].lDay+'日</span><br />'+
'<span class="ganzhi">'+cld[d].cYear+'年 '+cld[d].cMonth+'月 '+cld[d].cDay +'日</span>'+hltxt+
'</div>'+ festival +'</div>';

document.getElementById("detail").innerHTML = s;

if (snow == 0) {
dStyle.left = x+offsetx-(width/2)+"px";
dStyle.top = y+offsety+"px";
dStyle.display = "block";
snow = 1;
}
}
}

//清除詳細日期資料
function mOut() {
if ( cnt >= 1 ) { sw = 0; }
if ( sw == 0 ) { snow = 0; dStyle.display = "none";}
else cnt++;
}

//取得位置
function mEvn(event) {
if(event==null)event=window.event;//IE


x=event.x ? event.x : event.pageX
y=event.y ? event.y : event.pageY;
if (document.body.scrollLeft){
x=event.x+document.body.scrollLeft; y=event.y+document.body.scrollTop;
}
else if (snow){
dStyle.left = x+offsetx-(width/2)+"px";
dStyle.top = y+offsety+"px";
}
}


///////////////////////////////////////////////////////////////////////////

function setCookie(name, value) {
    var today = new Date()
    var expires = new Date()
    expires.setTime(today.getTime() + 1000*60*60*24*365)
    document.cookie = name + "=" + escape(value) + "; expires=" + expires.toGMTString()
}

function getCookie(Name) {
   var search = Name + "="
   if(document.cookie.length > 0) {
      offset = document.cookie.indexOf(search)
      if(offset != -1) {
         offset += search.length
         end = document.cookie.indexOf(";", offset)
         if(end == -1) end = document.cookie.length
         return unescape(document.cookie.substring(offset, end))
      }
      else return ""
   }
}

/////////////////////////////////////////////////////////
function initial() {
   dStyle = document.getElementById("detail").style;
   document.getElementById("CLD").SY.selectedIndex=tY-1900;
   document.getElementById("CLD").SM.selectedIndex=tM;
   drawCld(tY,tM);
   pushBtm('');
if (tM + 1==10 && tD<11 && tD>9) {alert('現在是國慶假期! 協坤 祝您國慶日快樂!')}
if (tM + 1==1 && tD<2) {alert('過節啦!! 今天是元旦!  hi123.ailexun.com/tool祝您新年快樂!')}
}

//-->
//原始的跟修改後的_修正today的顏色及全頁字型大小 _ *1.5倍
//<style>body{margin:0;background:#FFF;}.red{color:#F00;}.green{color:#090;}.blue{color:#00F;}#wrap{width:568px;margin:20px auto 0;overflow:hidden;}#YMBG{width:568px;height:336px;position:absolute;z-index:-1;top:20px;padding:56px 0 0;font:120px/140px "Arial Black";background:#EFF7FA;color:#E3EEF9;text-align:center;}.todyaColor{background:url(/img/today.gif) no-repeat center center;}.calendar{height:392px;font:12px Arial;border:solid #A1C6D9;border-width:1px 0 0 1px;}.calendar th{height:24px;font:bold 16px/24px Arial;background:#ADCEEF;border:1px solid;border-color:#FFF #A1C6D9 #A1C6D9 #FFF;}.calendar td{width:75px;height:50px;text-align:center;padding:2px;border:1px solid;border-color:#FFF #A1C6D9 #A1C6D9 #FFF;}.calendar td strong{display:block;font:bold 24px/28px Arial;}.calendar select{font:12px Arial;}.calendar .title{height:28px;font:16px Arial;background:none;}.topic{width:200px;padding:2px;background:#222;font:12px/18px Verdana;filter:alpha(opacity=90);opacity:0.9}.topic .con{padding:2px;}.gday{color:#FFF;}.nday{color:#F3F;}.ganzhi{color:#FF0;}.hlyi{color:#0F0;}.hlji{color:#F60;}.gzage{color:#F00;}.gznl{color:#090;}.festival{background:#CFC;padding:2px;}#footer{width:570px;text-align:center;margin:auto;font:12px/18px Arial;padding:8px;}#right{float:left;width:120px;padding-left:10px;}</style>

</script>
<style>
/* 原有的樣式 */
body{margin:0;background:#FFF;}.red{color:#F00;}.green{color:#090;}.blue{color:#00F;}#wrap{width:852px;margin:30px auto 0;overflow:hidden;}#YMBG{width:852px;height:504px;position:absolute;z-index:-1;top:30px;padding:84px 0 0;font:180px/210px "Arial Black";background:#EFF7FA;color:#E3EEF9;text-align:center;}.todyaColor{BACKGROUND-COLOR: aqua;}.calendar{height:588px;font:18px Arial;border:solid #A1C6D9;border-width:1px 0 0 1px;}.calendar th{height:36px;font:bold 24px/36px Arial;background:#ADCEEF;border:1px solid;border-color:#FFF #A1C6D9 #A1C6D9 #FFF;}.calendar td{width:112.5px;height:75px;text-align:center;padding:2px;border:1px solid;border-color:#FFF #A1C6D9 #A1C6D9 #FFF;}.calendar td strong{display:block;font:bold 36px/42px Arial;}.calendar select{font:18px Arial;}.calendar .title{height:42px;font:24px Arial;background:none;}.topic{width:300px;padding:2px;background:#222;font:18px/27px Verdana;filter:alpha(opacity=90);opacity:0.9}.topic .con{padding:2px;}.gday{color:#FFF;}.nday{color:#F3F;}.ganzhi{color:#FF0;}.hlyi{color:#0F0;}.hlji{color:#F60;}.gzage{color:#F00;}.gznl{color:#090;}.festival{background:#CFC;padding:2px;}#footer{width:855px;text-align:center;margin:auto;font:18px/27px Arial;padding:12px;}#right{float:left;width:180px;padding-left:15px;}
/* 新增的搜尋框樣式 */
.google-search-container {
    width: 100%;
    text-align: center;
    margin-top: 20px;
    padding: 20px;
    border-top: 1px solid #A1C6D9;
}
.google-search-container input[type="text"] {
    width: 300px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
}
.google-search-container button {
    padding: 10px 20px;
    border: none;
    background-color: #4285F4;
    color: white;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    margin-left: 10px;
    transition: background-color 0.3s;
}
.google-search-container button:hover {
    background-color: #357ae8;
}
</style>

</head>
<body onload="initial()">
<script language="javascript">

lck=0;
function r(hval)
{
if ( lck == 0 )
{
document.body.style.background=hval;
}
}
</script>
<form name="CLD" ID="CLD">
<table border="0" align="center" cellpadding="0" cellspacing="0">
<tr>
<td><div id="wrap">
<div id="YMBG">0000<br/>JUN</div>
<table border="0" cellspacing="0" cellpadding="0" class="calendar">
<tr>
<th colspan="7" class="title">
西曆 <select onchange="changeCld()" name="SY">
<script language="javascript">
          <!--
            for(i=1900;i<2050;i++) document.write('<option>'+i)
          //-->
          </script>
</select>
年 <select onchange="changeCld()" name="SM">
<script language="javascript">
          <!--
            for(i=1;i<13;i++) document.write('<option>'+i)
          //-->
          </script>
</select>
月
<span id="GZ"></span>
</th>
</tr>
<tr>
<th><span class="red">日</span></th>
<th>一</th>
<th>二</th>
<th>三</th>
<th>四</th>
<th>五</th>
<th><span class="green">六</span></th></tr>
<script language=javascript>
        <!--
            var gNum
            for(i=0;i<6;i++) {
               document.write('<tr>')
               for(j=0;j<7;j++) {
                  gNum = i*7+j
                  document.write('<td id="GD' + gNum +'" onmouseover="mOvr(' + gNum +')" onmouseout="mOut()"><div')
                  if(j == 0) document.write(' class="red"')
                  if(j == 6)
                     if(i%2==1) document.write(' class="red"')
                        else document.write(' class="green"')
                  document.write('><strong id="SD' + gNum +'"> </strong></div> <span id="LD' + gNum + '"> </span></td>')
               }
               document.write('</tr>')
            }
        //-->
        </script>
</table>
</div><div id="footer">
陽曆中<span class="red">紅色</span>/<span class="green">綠色</span>表示節假日，農曆中<span class="green">綠色</span>表示為24節氣日，<span class="red">紅色</span>表示為傳統節日，<span class="blue">藍色</span>為公眾節假日
</div></td>
<td>
<input type="button" onclick="pushBtm('YU')" value="年▲"/><br/>
<input type="button" onclick="pushBtm('YD')" value="年▼"/><br/><br/>
<input type="button" onclick="pushBtm('MU')" value="月▲"/><br/>
<input type="button" onclick="pushBtm('MD')" value="月▼"/><br/><br/>
<input type="button" onclick="pushBtm('')" value="今日"/><br/><br/><br/><br/><br/>
</td>
</tr>
</table>
</form>
<div id="detail" style="position:absolute;top:0;left:0;"></div>

<!-- 新增的 Google 搜尋框 -->
<div class="google-search-container">
    <form action="https://www.google.com/search" method="get">
        <input type="text" name="q" placeholder="使用 Google 搜尋..." required>
        <button type="submit">搜尋</button>
    </form>
</div>

</body>
</html>
